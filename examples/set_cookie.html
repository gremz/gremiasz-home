<html>
<head>
</head>
<body>
  <button>Set Cookie</button>
  <div class="cookieSet"></div>
  <script type="text/javascript">
    window.onload = (event) => {
      let cookies = document.cookie.split(';');
      let button = document.querySelector('button');
      let cookieText = document.querySelector('.cookieSet');


      let storageRequestPromise = document.hasStorageAccess();
      storageRequestPromise.then(
        function(hasAccess) {
          if (true) {
            cookieText.innerText = "Current cookies: " + document.cookie;
          } else {
            cookieText.innerText = "No Storage Access";
          }
        }, function(reason) {
          console.log('rejected request storagre');
        });

      button.addEventListener("click", (e) => { 
        e.preventDefault();
        let promise = document.requestStorageAccess();
        promise.then(
          function() {
            document.cookie = 'test_cookie=true';
            location.reload();
          },
          function() {
            cookieText.innerText = "Storage Permission denied";
          });
      });
    }
  </script>
</body>
</html>